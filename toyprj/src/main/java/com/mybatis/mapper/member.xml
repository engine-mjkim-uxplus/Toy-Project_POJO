<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.mybatis.mapper.member">  <!-- 쿼리 id = namespace + id -->

	<select id="getMember" parameterType="map" resultType="com.vo.MemberVO">
		SELECT * FROM MEMBER WHERE MEMBER_ID = #{id}
	</select>
	
	<update id="memberUpdateP" parameterType="map">
		UPDATE MEMBER
		   SET member_pw = #{member_pw}
		      ,member_name = #{member_name}
		      ,member_phone = #{member_phone}
		      ,member_zipcode = #{member_zipcode}
		      ,member_address = #{member_address}
		      ,member_address2 = #{member_address2}
		      ,member_gender = #{member_gender}
		 WHERE member_id = #{member_id}
	</update>

	<!-- [[ 회원 탈퇴할 때 무결성 제약조건 방지용 시작 ]] -->	
	<select id="getCart" parameterType="map" resultType="com.vo.CartVO">
		SELECT * FROM cart
		 WHERE member_id = #{member_id}
	</select>
	
	<delete id="delCart" parameterType="map">
		DELETE FROM cart
		 WHERE member_id = #{member_id}
	</delete>
	<select id="getLike" parameterType="map" resultType="com.vo.ProductVO">
		SELECT * FROM product_like
		 WHERE member_id = #{member_id}
	</select>
	
	<delete id="delLike" parameterType="map">
		DELETE FROM product_like
		 WHERE member_id = #{member_id}
	</delete>
	<!-- [[ 회원 탈퇴할 때 무결성 제약조건 방지용 끝 ]] -->	
	
	<delete id="memberDelete" parameterType="map">
		DELETE FROM MEMBER
		 WHERE member_id = #{member_id} and member_pw = #{member_pw}
	</delete>
	
	<!-- 좋아요 누른 상품 가져오기 -->
	<select id="memberListLike" parameterType="String" resultType="com.vo.ProductVO">
		SELECT P.PRODUCT_CATEGORY,P.PRODUCT_NAME
              ,P.PRODUCT_PRICE,P.PRODUCT_IMG,P.PRODUCT_NO
          FROM PRODUCT P , 
              (
               SELECT PRODUCT_NO FROM PRODUCT_LIKE 
                WHERE MEMBER_ID= #{member_id}
               ) C
         WHERE P.PRODUCT_NO = C.PRODUCT_NO
	</select>
	<!-- 구매내역 가져오기 -->
	<select id="memberListReview" parameterType="String" resultType="map">
	SELECT P.PRODUCT_NAME,P.PRODUCT_IMG,P.PRODUCT_NO
	      ,R.MEMBER_ID, R.REVIEW_CONTENT, R.REVIEW_SCORE, R.REVIEW_IMG, R.REVIEW_DATE
	  FROM PRODUCT P , PRODUCT_REVIEW  R
	 WHERE P.PRODUCT_NO = R.PRODUCT_NO and MEMBER_ID= #{member_id}
	</select>
	
</mapper>